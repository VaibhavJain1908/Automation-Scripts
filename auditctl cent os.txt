import subprocess

out1 = ['## This file is automatically generated from /etc/audit/rules.d\n', '\n', '-b 10240\n', '\n', '-w /etc/apparmor.d/ -p wa -k MAC-policy\n', '-w /etc/apparmor/ -p wa -k MAC-policy\n', '-w /etc/gshadow -p wa -k identity\n', '-w /etc/group -p wa -k identity\n', '-w /etc/passwd -p wa -k identity\n', '-w /etc/hosts -p wa -k system-locale\n', '-w /etc/issue -p wa -k system-locale\n', '-w /etc/issue.net -p wa -k system-locale\n', '-w /etc/localtime -p wa -k time-change\n', '-w /etc/security/opasswd -p wa -k identity\n', '-w /etc/selinux/ -p wa -k MAC-policy\n', '-w /etc/shadow -p wa -k identity\n', '-w /etc/sudoers -p wa -k scope\n', '-w /etc/sudoers.d/ -p wa -k scope\n', '-w /etc/sysconfig/network -p wa -k system-locale\n', '-w /etc/sysconfig/network/ -p wa\n', '-w /etc/sysconfig/network-scripts/ -p wa -k system-locale\n', '-w /sbin/insmod -p x -k modules\n', '-w /sbin/modprobe -p x -k modules\n', '-w /sbin/rmmod -p x -k modules\n', '-w /usr/share/selinux/ -p wa -k MAC-policy\n', '-w /var/log/btmp -p wa -k session\n', '-w /var/log/faillog -p wa -k logins\n', '-w /var/log/lastlog -p wa -k logins\n', '-w /var/log/sudo.log -p wa -k actions\n', '-w /var/log/tallylog -p wa -k logins\n', '-w /var/log/wtmp -p wa -k session\n', '-w /var/run/faillock/ -p wa -k logins\n', '-w /var/run/utmp -p wa -k session\n', '-w /bin/sudo -p a -k privileged\n', '-a always,exit -F arch=b32 -S chmod -F auid>=1000 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b64 -S clock_settime -k time-change\n', '-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n', '-a always,exit -F arch=b32 -S fchmod -F auid>=1000 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b32 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b64 -S fremovexattr -F auid>=500 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b64 -S fsetxattr -F auid>=500 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b64 -S lremovexattr -F auid>=500 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b64 -S lsetxattr -F auid>=500 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b64 -S removexattr -F auid>=500 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid>=500 -F auid!=4294967295 -k delete\n', '-a always,exit -F arch=b64 -S setdomainname -k system-locale\n', '-a always,exit -F arch=b64 -S sethostname -k system-locale\n', '-a always,exit -F arch=b64 -S setxattr -F auid>=500 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b32 -S stime,settimeofday,adjtimex -F key=time-change\n', '-a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat -F exit=-EACCES -F auid>=1000 -F auid!=-1 -F key=access\n', '-a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F exit=-EACCES -F auid>=1000 -F auid!=-1 -F key=access\n', '-a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat -F exit=-EPERM -F auid>=1000 -F auid!=-1 -F key=access\n', '-a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F exit=-EPERM -F auid>=1000 -F auid!=-1 -F key=access\n', '-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=500 -F auid!=4294967295 -k access\n', '-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=500 -F auid!=4294967295 -k access\n', '-a always,exit -F path=/bin/ping6 -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n', '-a always,exit -F path=/bin/fusermount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n', '-a always,exit -F path=/bin/mount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n', '-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n', '-a always,exit -F arch=b64 -S mount -F auid=0 -k mounts\n', '-a always,exit -F arch=b32 -S mount -F auid=0 -k mounts\n', '-w /bin/sudo -p a -k privileged\n', '-a always,exit -F arch=b64 -S mount -F auid>=500 -F auid!=4294967295 -k mounts\n', '-a always,exit -F arch=b32 -S mount -F auid>=500 -F auid!=4294967295 -k mounts\n', '-a always,exit -F arch=b64 -S mount -F auid=0 -k mounts\n', '-a always,exit -F arch=b32 -S mount -F auid=0 -k mounts\n', '-w /bin/kmod -p x -k auoms -k kernelmodules\n', '-w /var/log/audit -p wxa -k audittampering -k auoms\n', '-w /etc/audit -p wxa -k audittampering -k auoms\n', '-w /etc/passwd -p x -k auoms -k usergroup\n', '-w /etc/group -p x -k auoms -k usergroup\n', '-w /etc/pam.d -p wxa -k auoms -k pam\n', '-a always,exit -F arch=b32 -S execve,execveat -F key=auoms\n', '-a always,exit -F arch=b64 -S execve,execveat -F key=auoms\n', '-w /usr/bin/docker -k docker\n', '-w /var/lib/docker -k docker\n', '-w /etc/docker -k docker\n', '-w /usr/lib/systemd/system/docker-registry.service -k docker\n', '-w /usr/lib/systemd/system/docker.service -k docker\n', '-w /var/run/docker.sock -k docker\n', '-w /etc/sysconfig/docker -k docker\n', '-w /etc/sysconfig/docker-network -k docker\n', '-w /etc/sysconfig/docker-registry -k docker\n', '-w /etc/sysconfig/docker-storage -k docker\n', '-w /etc/default/docker -k docker\n', '-a exit,never -F arch=b64 -F pid=0 -S 41 -S 42 -S 49 -S 82 -S 84 -S 87 -S 263 -k mdatp\n', '-a exit,never -F arch=b64 -F pid=1635 -S 41 -S 42 -S 49 -S 82 -S 84 -S 87 -S 263 -k mdatp\n', '-a exit,never -F arch=b64 -F pid=1808 -S 41 -S 42 -S 49 -S 82 -S 84 -S 87 -S 263 -k mdatp\n', '-a exit,never -F arch=b64 -F pid=2055 -S 41 -S 42 -S 49 -S 82 -S 84 -S 87 -S 263 -k mdatp\n', '-a exit,never -F arch=b64 -F pid=2120 -S 41 -S 42 -S 49 -S 82 -S 84 -S 87 -S 263 -k mdatp\n', '-a exit,never -F arch=b64 -F pid=396 -S 41 -S 42 -S 49 -S 82 -S 84 -S 87 -S 263 -k mdatp\n', '-a exit,never -F arch=b32 -F dir=/dev/shm -S 10 -k mdatp\n', '-a exit,never -F arch=b64 -F dir=/dev/shm -S 87 -k mdatp\n', '-a exit,always -F a0=10 -F arch=b64 -F success=1 -S 41 -k mdatp\n', '-a exit,always -F a0=2 -F arch=b64 -F success=1 -S 41 -k mdatp\n', '-a exit,always -F a2=16 -F arch=b64 -S 42 -k mdatp\n', '-a exit,always -F a2=16 -F arch=b64 -F success=1 -S 49 -k mdatp\n', '-a exit,always -F a2=28 -F arch=b64 -S 42 -k mdatp\n', '-a exit,always -F a2=28 -F arch=b64 -F success=1 -S 49 -k mdatp\n', '-a exit,always -F arch=b32 -F success=1 -S 10 -S 38 -S 40 -S 102 -S 301 -S 302 -S 353 -k mdatp\n', '-a exit,always -F arch=b64 -F success=1 -S 43 -S 82 -S 84 -S 87 -S 263 -S 264 -S 288 -S 316 -k mdatp\n', '-e 2\n']

with open("/etc/audit/rules.d/audit.rules", "w") as f:
    f.writelines(out1)
    
with open("/etc/audit/audit.rules", "w") as f:
    f.writelines(out1)

process = subprocess.Popen(["auditctl", "-l"], stdin=subprocess.PIPE, stdout=subprocess.PIPE)
print process.communicate()[0]

process = subprocess.Popen(["augenrules", "--load"], stdin=subprocess.PIPE, stdout=subprocess.PIPE)
print process.communicate()[0]
